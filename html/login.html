<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/default.css">
    <link rel="stylesheet" type="text/css" href="../css/header&footer.css"/>
    <link rel="stylesheet" type="text/css" href="../css/font.css"/>
    <link rel="stylesheet" href="../css/login.css">
    <title>化妆品</title>
    <script src="../JS/jquery-1.6.4.min.js" type="text/javascript"></script>
    <!--[if IE]>
    <script src="http://libs.useso.com/js/html5shiv/3.7/html5shiv.min.js"></script>
    <![endif]-->
    <!–[if lt IE 7]>
    <script src=”http://ie7-js.googlecode.com/svn/version/2.0(beta)/IE7.js” type=”text/javascript”></script>
    <![endif]–>
    <!–[if lt IE 8]>
    <script src=”http://ie7-js.googlecode.com/svn/version/2.0(beta)/IE8.js” type=”text/javascript”></script>
    <![endif]–>

</head>
<body class="dress-body">
<div class="dress-container">
    <div class="dress-login-page">
        <div class="dress-form">
            <!--注册表单-->
            <section class="dress-register-form" action="register.php" method="post">
                <input type="text" class="usePhone" name="usePhone" placeholder="手机号"/>
                <div class="dress-register-error">
                    请在此输入您的手机号
                </div>
                <input type="password" class="usePass" name="usePass" placeholder="密码"/>
                <div class="dress-register-error">
                    密码格式 : 6-18位字母或数字
                </div>
                <input type="text" class="useEmail" name="useEmail" placeholder="电子邮件"/>
                <input type="submit" class="dress_registerBt" value="创建账户"/>
                <p class="dress-message">已经有了一个账户? <a href="javascript:;">立刻登录</a></p>
            </section>
            <!--登录表单-->
            <section class="dress-login-form">
                <input type="text" class="useLoginName" name="useLoginName" placeholder="手机号" autocomplete="off"/>
                <div class="dress-check-error">

                </div>
                <input type="password" class="useLoginPass" name="useLoginPass" placeholder="密码"/>
                <input type="submit" class="dress_loginBt" value="登录"/>
                <p class="dress-message">还没有账户? <a href="javascript:;">立刻创建</a></p>
            </section>
        </div>
    </div>
</div>

<footer class="jkj-footer">
    <div class="footerTop">
        <div class="footerService">
            <div class="service1">
                <a href="offline.html" target="_self">
                    <h3>线下体验</h3>   <!-- 斜体显示 -->
                    <p>
                        <span>2300 +</span>
                        <span>全国门店邀您体验</span>
                    </p>
                </a>
            </div>

            <div class="service2">
                <a href="myOrderList.html" target="_self">
                    <h3>服务支持</h3>
                    <p>
                        <span>获取更多支持</span>
                        <span>售前咨询，售后保障</span>
                    </p>
                </a>
            </div>

            <div class="service3">
                <a href="firsrPage.html" target="_blank">
                    <h3>在线选购</h3>
                    <p>
                        <span>15天换货保障</span>
                        <span>7天无理由退换货</span>
                    </p>
                </a>
            </div>
        </div>
        <div class="onliveServer">
            <span>24小时全国服务热线</span>
            <p class="tel">184-3520-7089</p>
            <div>
                <a class="onliveBtn" href="javascript:void 0;" style="line-height: 40px">
                    <span class="glyphicon glyphicon-comment" style="line-height: 40px"></span>
                    <span> 在线客服</span>
                </a>
                <img id="erwei" src="../img/firsrPage/footer/erwei.png" alt="在这里">
            </div>

        </div>
    </div>


    <hr class="hr"/>
    <div class="footBottom">
        <ul class="aboutUs">
            <li>
                <a href="aboutUs.html">联系我们</a> <span></span>
            </li>
        </ul>

        <div class="last">
            ©2017 Meizu Telecom Equipment Co., Ltd. All rights reserved.&nbsp;&nbsp;&nbsp;&nbsp;
            <a target="_blank" href="#">粤ICP备13003602号</a>
            <a target="_blank" href="#">合字B2-20170010 </a>
            <a target="_blank" href="#">营业执照</a>
            <a target="_blank" href="#">法律声明</a>
            <a target="_blank" href="">
                粤公网安备 44049102496009 号
            </a>
        </div>
    </div>
</footer>
</body>
<script type="text/javascript">
    (function () {
        //居中定位
        var borwerHeight = 600;
        var pageHeight = $(".dress-login-page")[0].clientHeight;
        var h = (borwerHeight - pageHeight) / 3;
        $(".dress-form").css({"top": h + "px"});
    })();
    //进行登录注册的切换
    $(function () {
        $('.dress-message a').click(function () {
            $('section').animate({
                height: 'toggle',
                opacity: 'toggle'
            }, 'slow');
        });
        /*输入框获取失去焦点的操作*/
        $("input[type='text'],input[type='email'],input[type='password']").focus(function () {
            $(this).css('border', '1px #5079DF solid');
        });
        $("input[type='text'],input[type='email'],input[type='password']").blur(function () {
            $(this).css('border', '1px #c5c5c5  solid');
        });
    });
    /*登录事件*/
    $(function () {
        var checkName = false;
        var checkPass = false;
        var intUserVal = null;
        var intPassVal = null;
        $(".useLoginName").bind('change keydown', function () {
            intUserVal = $(this).val();
            var name_patt = /^1[34578]\d{9}$/;
            //console.log(intUserVal);
            if (name_patt.test(intUserVal)) {
                checkName = true;
            } else {
                checkName = false;
            }
            /*对两次输入的值判断以改变bt的背景颜色*/
            if (checkName && checkPass) {
                $(".dress_loginBt").css({"background": "rgb(87,127,209)"});
            } else {
                $(".dress_loginBt").css({"background": "rgb(186,203,237)"});
            }
        });
        $(".useLoginPass").bind('change keydown', function () {
            intPassVal = $(this).val();
            var pass_patt = /^[a-z0-9]{6,18}$/;
            //console.log(intPassVal);
            if (checkName) {
                if (pass_patt.test(intPassVal)) {
                    checkPass = true;
                    /*对两次输入的值判断以改变bt的背景颜色*/
                    if (checkName && checkPass) {
                        $(".dress_loginBt").css({"background": "rgb(87,127,209)"});
                    } else {
                        $(".dress_loginBt").css({"background": "rgb(186,203,237)"});
                    }
                } else {
                    checkPass = false;
                    if (checkName && checkPass) {
                        $(".dress_loginBt").css({"background": "rgb(87,127,209)"});
                    } else {
                        $(".dress_loginBt").css({"background": "rgb(186,203,237)"});
                    }
                }
            }
        });
        /*点击提交后的事件*/
        $(".dress_loginBt").click(function () {
            event.preventDefault(); // 兼容标准浏览器
            window.event.returnValue = false; // 兼容IE6~8
            if (checkName && checkPass) {
                $.ajax({
                    type: "post",
                    url: "../phpFile/login.php",
                    data: {
                        useLoginName: intUserVal,
                        useLoginPass: intPassVal
                    },
                    async: true,
                    success: function (data) {
                        console.log(data);
                        if (data == "error") {
                            alert("登陆失败,请确认账号密码");
                        } else if (data == "right") {
                            setCookie('username', intUserVal, 1800);
                            setCookie('userpass', intPassVal, 1800);
                            window.location.href = "firsrPage.html";
                        }
                    }
                });
            } else {
                return false;
            }
        });
    })
    /*注册表事件*/
    $(function () {
        var newName = false;
        var newPass = false;
        var newEmail = false;
        var newNameVal = null;
        var newPassVal = null;
        var newEmailVal = null;
        //输入的手机号
        $(".usePhone").bind('change keydown', function () {
            newNameVal = $(this).val();
            var name_patt = /^1[34578]\d{9}$/;
            //console.log(intUserVal);
            if (name_patt.test(newNameVal)) {
                newName = true;
            } else {
                newName = false;
            }
            /*对两次输入的值判断以改变bt的背景颜色*/
            if (newName && newPass && newEmail) {
                $(".dress_registerBt").css({"background": "rgb(87,127,209)"});
            } else {
                $(".dress_registerBt").css({"background": "rgb(186,203,237)"});
            }
        });
        $(".usePass").bind('change keydown', function () {
            newPassVal = $(this).val();
            var pass_patt = /^[a-z0-9]{6,18}$/;
            if (newName) {
                if (pass_patt.test(newPassVal)) {
                    newPass = true;
                    /*对两次输入的值判断以改变bt的背景颜色*/
                    if (newName && newPass && newEmail) {
                        $(".dress_registerBt").css({"background": "rgb(87,127,209)"});
                    } else {
                        $(".dress_registerBt").css({"background": "rgb(186,203,237)"});
                    }
                } else {
                    newPass = false;
                    if (newName && newPass && newEmail) {
                        $(".dress_registerBt").css({"background": "rgb(87,127,209)"});
                    } else {
                        $(".dress_registerBt").css({"background": "rgb(186,203,237)"});
                    }
                }
            }
        });
        $(".useEmail").bind('change keydown', function () {
            newEmailVal = $(this).val();
            var email_patt = /^(\w)+(\.\w+)*@(\w)+((\.\w{2,3}){1,3})$/;
            if (newName && newPass) {
                if (email_patt.test(newEmailVal)) {
                    newEmail = true;
                    /*对两次输入的值判断以改变bt的背景颜色*/
                    if (newName && newPass && newEmail) {
                        $(".dress_registerBt").css({"background": "rgb(87,127,209)"});
                    } else {
                        $(".dress_registerBt").css({"background": "rgb(186,203,237)"});
                    }
                } else {
                    newEmail = false;
                    if (newName && newPass && newEmail) {
                        $(".dress_registerBt").css({"background": "rgb(87,127,209)"});
                    } else {
                        $(".dress_registerBt").css({"background": "rgb(186,203,237)"});
                    }
                }
            }
        });
        $(".dress_registerBt").click(function () {
            event.preventDefault(); // 兼容标准浏览器
            window.event.returnValue = false; // 兼容IE6~8
            if (newName && newPass && newEmail) {
                $.ajax({
                    type: "post",
                    url: "../phpFile/register.php",
                    data: {
                        usePhone: newNameVal,
                        usePass: newPassVal,
                        useEmail: newEmailVal
                    },
                    async: true,
                    success: function (data) {
                        console.log(data);
                        if (data == 'error') {
                            alert("该手机号已经注册,请重新操作");
                        } else if (data == "right") {
                            setCookie('username', newNameVal, 1800);
                            setCookie('userpass', newPassVal, 1800);
                            window.location.href = "firsrPage.html";
                        }
                    }
                });
            } else {
                return false;
            }
        });

    });
    //设置cookie
    function setCookie(name, value, seconds) {
        seconds = seconds || 0; //seconds有值就直接赋值，没有为0，这个根php不一样。
        var expires = "";
        if (seconds != 0) { //设置cookie生存时间
            var date = new Date();
            date.setTime(date.getTime() + (seconds * 1000));
            expires = "; expires=" + date.toGMTString();
        }
        document.cookie = name + "=" + escape(value) + expires + "; path=/"; //转码并赋值
    }
    //获取cookie
    function getCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';'); //把cookie分割成组
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i]; //取得字符串
            while (c.charAt(0) == ' ') { //判断一下字符串有没有前导空格
                c = c.substring(1, c.length); //有的话，从第二位开始取
            }
            if (c.indexOf(nameEQ) == 0) { //如果含有我们要的name
                return unescape(c.substring(nameEQ.length, c.length)); //解码并截取我们要值
            }
        }
        return false;
    }
    //清除cookie
    function clearCookie(name) {
        setCookie(name, "", -1);
    }
</script>
</html>